graph TD
    START[Arquivo Recebido] --> CHECK_SIZE{Tamanho do Arquivo?}
    
    CHECK_SIZE -->|≤ 100 bytes| SMALL[Arquivo Pequeno]
    CHECK_SIZE -->|100 bytes < x ≤ 1KB| MEDIUM[Arquivo Médio]
    CHECK_SIZE -->|> 1KB| LARGE[Arquivo Grande]
    
    SMALL --> SMALL_FRAG[1 Fragmento]
    SMALL_FRAG --> SMALL_REP[2 Réplicas]
    SMALL_REP --> SMALL_DIST[Distribuir para<br/>2 nodos]
    
    MEDIUM --> MED_FRAG[2 Fragmentos]
    MED_FRAG --> MED_REP[2 Réplicas por fragmento]
    MED_REP --> MED_DIST[Distribuir para<br/>4 nodos<br/>2 nodos x fragmento]
    
    LARGE --> LARGE_FRAG[4 Fragmentos]
    LARGE_FRAG --> LARGE_REP[4 Réplicas por fragmento]
    LARGE_REP --> LARGE_DIST[Distribuir para<br/>múltiplos nodos<br/>4 nodos x fragmento]
    
    SMALL_DIST --> SELECT[Selecionar nodos com<br/>menor carga]
    MED_DIST --> SELECT
    LARGE_DIST --> SELECT
    
    SELECT --> BALANCE[Balanceamento de Carga]
    BALANCE --> STORE[Armazenar fragmentos<br/>nos nodos selecionados]
    STORE --> UPDATE[Atualizar metadados<br/>em files_db.json]
    UPDATE --> END[Concluído]
    
    style SMALL fill:#90EE90
    style MEDIUM fill:#FFD700
    style LARGE fill:#FF6347
    style SELECT fill:#87CEEB
    style BALANCE fill:#DDA0DD
    style UPDATE fill:#F0E68C
